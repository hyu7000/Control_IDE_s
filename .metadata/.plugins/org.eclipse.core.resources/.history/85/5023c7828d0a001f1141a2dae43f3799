import org.eclipse.core.resources.IFile;
import org.eclipse.core.resources.IProject;
import org.eclipse.core.resources.ResourcesPlugin;
import org.eclipse.core.runtime.CoreException;
import org.eclipse.jface.viewers.ISelection;
import org.eclipse.jface.viewers.IStructuredSelection;
import org.eclipse.ui.IWorkbenchWindow;
import org.eclipse.ui.PlatformUI;
import org.eclipse.ui.ide.ResourceUtil;

public class ControlAction {
	public void buildActiveProject() {
        PlatformUI.getWorkbench().getDisplay().asyncExec(new Runnable() {
            public void run() {
                try {
                    IWorkbenchWindow window = PlatformUI.getWorkbench().getActiveWorkbenchWindow();
                    if (window != null) {
                        ISelection selection = window.getSelectionService().getSelection();
                        if (selection instanceof IStructuredSelection) {
                            Object element = ((IStructuredSelection) selection).getFirstElement();
                            IFile file = ResourceUtil.getFile(element);
                            if (file != null) {
                                IProject project = file.getProject();
                                project.build(org.eclipse.core.resources.IncrementalProjectBuilder.INCREMENTAL_BUILD, null);
                                System.out.println("Active project build initiated: " + project.getName());
                            }
                        }
                    }
                } catch (CoreException e) {
                    System.err.println("Failed to build the active project.");
                    e.printStackTrace();
                }
            }
        });
    }
}
