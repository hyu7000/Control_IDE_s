import org.eclipse.core.resources.IFile;
import org.eclipse.core.resources.IProject;
import org.eclipse.core.resources.ResourcesPlugin;
import org.eclipse.core.runtime.CoreException;
import org.eclipse.jface.viewers.ISelection;
import org.eclipse.jface.viewers.IStructuredSelection;
import org.eclipse.ui.IWorkbenchWindow;
import org.eclipse.ui.PlatformUI;
import org.eclipse.ui.ide.ResourceUtil;

public class ControlAction {
	public void buildActiveProject() {
        PlatformUI.getWorkbench().getDisplay().asyncExec(new Runnable() {
            public void run() {
                try {
                    System.out.println("Attempting to access the active workbench window...");
                    IWorkbenchWindow window = PlatformUI.getWorkbench().getActiveWorkbenchWindow();
                    if (window != null) {
                        System.out.println("Workbench window is active. Accessing the active page...");
                        IWorkbenchPage page = window.getActivePage();
                        if (page != null) {
                            IEditorPart activeEditor = page.getActiveEditor();
                            if (activeEditor != null) {
                                System.out.println("Editor part is active. Retrieving file input...");
                                IFileEditorInput input = (IFileEditorInput) activeEditor.getEditorInput();
                                IProject project = input.getFile().getProject();
                                System.out.println("Initiating build for project: " + project.getName());
                                project.build(org.eclipse.core.resources.IncrementalProjectBuilder.INCREMENTAL_BUILD, null);
                                System.out.println("Build initiated successfully for project: " + project.getName());
                            } else {
                                System.out.println("No active editor found.");
                            }
                        } else {
                            System.out.println("No active page found.");
                        }
                    } else {
                        System.out.println("No active workbench window found.");
                    }
                } catch (CoreException e) {
                    System.err.println("Failed to build the active project.");
                    e.printStackTrace();
                } catch (ClassCastException e) {
                    System.err.println("Current open file is not part of a project.");
                    e.printStackTrace();
                }
            }
        });
    }
}
